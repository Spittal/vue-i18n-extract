!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("commander"),require("path"),require("is-valid-glob"),require("glob"),require("fs"),require("dot-object"),require("js-yaml"),require("esm")):"function"==typeof define&&define.amd?define(["commander","path","is-valid-glob","glob","fs","dot-object","js-yaml","esm"],t):t((e=e||self).commander,e.path,e.isValidGlob,e.glob,e.fs,e.dot,e.yaml,e.esm)}(this,function(e,t,a,r,n,o,s,l){function*i(e,t,a){for(void 0===a&&(a=1);;){var r=t.exec(e.content);if(null===r)break;var n=(e.content.substring(0,r.index).match(/\n/g)||[]).length+1;yield{path:r[a],line:n,file:e.fileName}}}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var c;t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o,s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,l=l&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l,require=l(module),function(e){e[e.None=0]="None",e[e.Missing=1]="Missing",e[e.Unused=2]="Unused",e[e.All=3]="All"}(c||(c={}));var f=new e.Command;f.command("report",{isDefault:!0}).description("Create a report from a glob of your Vue.js source files and your language files.").requiredOption("-v, --vueFiles <vueFiles>","The Vue.js file(s) you want to extract i18n strings from. It can be a path to a folder or to a file. It accepts glob patterns. (ex. *, ?, (pattern|pattern|pattern)").requiredOption("-l, --languageFiles <languageFiles>","The language file(s) you want to compare your Vue.js file(s) to. It can be a path to a folder or to a file. It accepts glob patterns (ex. *, ?, (pattern|pattern|pattern) ").option("-o, --output <output>","Use if you want to create a json file out of your report. (ex. -o output.json)").option("-a, --add","Use if you want to add missing keys into your json language files. (ex. -a true)").action(async function(e){var{vueFiles:l,languageFiles:f,output:p,add:d}=e,g=t.resolve(process.cwd(),l),y=t.resolve(process.cwd(),f),h=function(e,t,a){void 0===a&&(a=c.All);var r=[],n=[];Object.keys(t).forEach(a=>{var o=t[a];e.forEach(e=>{var n=function(t){return t.path===e.path||t.path.startsWith(e.path+".")};t[a].some(n)||r.push(u({},e,{language:a})),o=o.filter(e=>!n(e))}),n.push(...o.map(e=>u({},e,{language:a})))});var o={};return a&c.Missing&&(o=Object.assign(o,{missingKeys:r})),a&c.Unused&&(o=Object.assign(o,{unusedKeys:n})),o}(function(e){if(!a(e))throw new Error("vueFiles isn'\t a valid glob pattern.");var t=r.sync(e);if(0===t.length)throw new Error("vueFiles glob has no files.");return t.map(e=>({fileName:e.replace(process.cwd(),""),path:e,content:n.readFileSync(e,"utf8")}))}(g).reduce((e,t)=>[...e,...function(e){return[...i(e,/(?:[$ .]tc?)\(\s*?(["'`])((?:[^\\]|\\.)*?)\1/g,2)]}(t),...function(e){return[...i(e,/(?:<i18n|<I18N)(?:.|\n)*?(?:[^:]path=("|'))(.*?)\1/g,2)]}(t),...function(e){return[...i(e,/v-t="'(.*?)'"/g)]}(t)],[]),function(e){if(!a(e))throw new Error("languageFiles isn'\t a valid glob pattern.");var o=r.sync(e);if(0===o.length)throw new Error("languageFiles glob has no files.");return o.map(e=>{var a=t.resolve(process.cwd(),e),r=a.substring(a.lastIndexOf(".")).toLowerCase(),o=".yaml"===r||".yml"===r?s.safeLoad(n.readFileSync(a,"utf8")):require(a),l=o.default?o.default:o;return{fileName:e.replace(process.cwd(),""),path:e,content:l}})}(y).reduce((e,t)=>{var a=t.fileName.substring(t.fileName.lastIndexOf("/")+1,t.fileName.lastIndexOf(".")),r=o.dot(t.content),n=Object.keys(r).map((e,a)=>({line:a,path:e,file:t.fileName}));return e[a]=n,e},{}));h.missingKeys&&console.table(h.missingKeys),h.unusedKeys&&console.table(h.unusedKeys),p&&(await async function(e,t){var a=JSON.stringify(e);return new Promise((e,r)=>{n.writeFile(t,a,t=>{t?r(t):e()})})}(h,t.resolve(process.cwd(),p)),console.log("The report has been has been saved to "+p)),d&&h.missingKeys&&h.missingKeys.length>0&&(function(e,t){var a=r.sync(e),s=a.map(e=>n.readFileSync(e,"utf8")).map(e=>JSON.parse(e));t.forEach(e=>{s.forEach(t=>o.str(e.path,"",t))}),s.map(e=>JSON.stringify(e,null,2)).forEach((e,t)=>n.writeFileSync(a[t],e))}(y,h.missingKeys),console.log("The missing keys has been has been saved to your languages files"))}),f.parseAsync(process.argv)});
//# sourceMappingURL=vue-i18n-extract.umd.js.map
