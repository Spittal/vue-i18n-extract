!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("path"),require("is-valid-glob"),require("glob"),require("fs"),require("dot-object"),require("js-yaml"),require("esm")):"function"==typeof define&&define.amd?define(["exports","path","is-valid-glob","glob","fs","dot-object","js-yaml","esm"],t):t((e=e||self).vueI18NExtract={},e.path,e.isValidGlob,e.glob,e.fs,e.dot,e.yaml,e.esm)}(this,function(e,t,r,a,n,s,o,l){function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function u(e){if(!r(e))throw new Error("vueFiles isn't a valid glob pattern.");var t=a.sync(e);if(0===t.length)throw new Error("vueFiles glob has no files.");return t.map(e=>({fileName:e.replace(process.cwd(),""),path:e,content:n.readFileSync(e,"utf8")}))}function*c(e,t,r){for(void 0===r&&(r=1);;){var a=t.exec(e.content);if(null===a)break;var n=(e.content.substring(0,a.index).match(/\n/g)||[]).length+1;yield{path:a[r],line:n,file:e.fileName}}}function p(e){return u(e).reduce((e,t)=>[...e,...function(e){return[...c(e,/(?:[$ .]tc?)\(\s*?(["'`])((?:[^\\]|\\.)*?)\1/g,2)]}(t),...function(e){return[...c(e,/(?:<i18n|<I18N)(?:.|\n)*?(?:[^:]path=("|'))(.*?)\1/g,2)]}(t),...function(e){return[...c(e,/v-t="'(.*?)'"/g)]}(t)],[])}function f(e){if(!r(e))throw new Error("languageFiles isn't a valid glob pattern.");var s=a.sync(e);if(0===s.length)throw new Error("languageFiles glob has no files.");return s.map(e=>{var r=t.resolve(process.cwd(),e),a=r.substring(r.lastIndexOf(".")).toLowerCase(),s=".yaml"===a||".yml"===a?o.safeLoad(n.readFileSync(r,"utf8")):require(r),l=s.default?s.default:s;return{fileName:e.replace(process.cwd(),""),path:e,content:JSON.stringify(l)}})}function d(e,r){f(e).forEach(e=>{var a=JSON.parse(e.content);r.forEach(t=>{(t.language&&e.fileName.includes(t.language)||!t.language)&&s.str(t.path,"",a)});var l=e.fileName.substring(e.fileName.lastIndexOf(".")+1),i=t.resolve(process.cwd()+e.fileName),u=JSON.stringify(a,null,2);if("json"===l)n.writeFileSync(i,u);else if("js"===l)n.writeFileSync(i,"export default "+u+"; \n");else if("yaml"===l||"yml"===l){var c=o.safeDump(a);n.writeFileSync(i,c)}})}function g(e){return f(e).reduce((e,t)=>{var r=t.fileName.substring(t.fileName.lastIndexOf("/")+1,t.fileName.lastIndexOf(".")),a=s.dot(JSON.parse(t.content)),n=Object.keys(a).map((e,r)=>({line:r,path:e,file:t.fileName}));return e[r]=n,e},{})}var y;function h(t,r,a){void 0===a&&(a=e.VueI18NExtractReportTypes.All);var n=[],s=[];Object.keys(r).forEach(e=>{var a=r[e];t.forEach(t=>{var s=function(e){return e.path===t.path||e.path.startsWith(t.path+".")};r[e].some(s)||n.push(i({},t,{language:e})),a=a.filter(e=>!s(e))}),s.push(...a.map(t=>i({},t,{language:e})))});var o={};return a&e.VueI18NExtractReportTypes.Missing&&(o=Object.assign(o,{missingKeys:n})),a&e.VueI18NExtractReportTypes.Unused&&(o=Object.assign(o,{unusedKeys:s})),o}async function m(e,t){var r=JSON.stringify(e);return new Promise((e,a)=>{n.writeFile(t,r,t=>{t?a(t):e()})})}function v(e,r){var a=t.resolve(process.cwd(),e),n=t.resolve(process.cwd(),r);return h(p(a),g(n))}async function b(e){var{vueFiles:r,languageFiles:a,output:n,add:s}=e,o=v(r,a);o.missingKeys&&console.table(o.missingKeys),o.unusedKeys&&console.table(o.unusedKeys),n&&(await m(o,t.resolve(process.cwd(),n)),console.log("The report has been has been saved to "+n)),s&&o.missingKeys&&o.missingKeys.length>0&&(d(t.resolve(process.cwd(),a),o.missingKeys),console.log("The missing keys have been added to your languages files"))}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o,l=l&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l,require=l(module),(y=e.VueI18NExtractReportTypes||(e.VueI18NExtractReportTypes={}))[y.None=0]="None",y[y.Missing=1]="Missing",y[y.Unused=2]="Unused",y[y.All=3]="All";var w=i({},{__proto__:null,createI18NReport:v,reportCommand:b,readVueFiles:u,parseVueFiles:p,writeMissingToLanguage:d,parseLanguageFiles:g,get VueI18NExtractReportTypes(){return e.VueI18NExtractReportTypes},extractI18NReport:h,writeReportToFile:m});e.createI18NReport=v,e.default=w,e.extractI18NReport=h,e.parseLanguageFiles=g,e.parseVueFiles=p,e.readVueFiles=u,e.reportCommand=b,e.writeMissingToLanguage=d,e.writeReportToFile=m});
//# sourceMappingURL=vue-i18n-extract.umd.js.map
