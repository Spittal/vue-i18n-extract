{"version":3,"file":"vue-i18n-extract.umd.js","sources":["../src/config-file/vue-i18n-extract.config.js","../src/config-file/index.ts","../src/report-command/vue-files.ts","../src/report-command/language-files.ts","../src/report-command/report.ts","../src/report-command/index.ts"],"sourcesContent":["export default {\n  // Options documented in vue-i18n-extract readme.\n  vueFiles: './src/**/*.?(js|vue)',\n  languageFiles: './lang/**/*.?(json|yaml|yml|js)',\n  output: false,\n  add: false,\n  ci: false,\n};\n","import fs from 'fs';\nimport path from 'path';\nimport defaultConfig from './vue-i18n-extract.config.js';\n\nexport function initCommand(): void {\n  fs.writeFileSync(\n    path.resolve(process.cwd(), './vue-i18n-extract.config.js'),\n    `module.exports = ${JSON.stringify(defaultConfig, null, 2)}`,\n  );\n}\n\nexport function resolveConfig (): string[] | void {\n  try {\n    const pathToConfigFile = path.resolve(process.cwd(), './vue-i18n-extract.config.js');\n    // eslint-disable-next-line @typescript-eslint/no-var-requires\n    const configFile = require(pathToConfigFile);\n\n    console.info(`\\n[vue-i18n-extract] Using config file found at ${pathToConfigFile}\\n`);\n\n    const argsFromConfigFile: string[] = Object.keys(configFile).map(key => `--${key}`).reduce((accumulator, key, index) => {\n      const value = Object.values(configFile)[index];\n      if (value) {\n        return [\n          ...accumulator,\n          key,\n          ...((value === true) ? [] : [value]) as string[],\n        ];\n      }\n      return accumulator;\n    }, [] as string[]);\n\n    const argv = [\n      ...process.argv,\n      ...argsFromConfigFile,\n    ];\n\n    return argv;\n  } catch {}\n}\n","import { SimpleFile, I18NItemWithBounding } from '../types';\nimport isValidGlob from 'is-valid-glob';\nimport glob from 'glob';\nimport fs from 'fs';\n\nexport function readVueFiles (src: string): SimpleFile[] {\n  if (!isValidGlob(src)) {\n    throw new Error(`vueFiles isn't a valid glob pattern.`);\n  }\n\n  const targetFiles = glob.sync(src);\n\n  if (targetFiles.length === 0) {\n    throw new Error('vueFiles glob has no files.');\n  }\n\n  return targetFiles.map((f) => {\n    const fileName = f.replace(process.cwd(), '');\n    return { fileName, path: f, content: fs.readFileSync(f, 'utf8') };\n  });\n}\n\nfunction* getMatches (file: SimpleFile, regExp: RegExp, captureGroup = 1): IterableIterator<I18NItemWithBounding> {\n  while (true) {\n    const match = regExp.exec(file.content);\n    if (match === null) {\n      break;\n    }\n    const path = match[captureGroup];\n\n    const pathAtIndex = file.content.indexOf(path);\n    const previousCharacter = file.content.charAt(pathAtIndex - 1);\n    const nextCharacter = file.content.charAt(pathAtIndex + path.length);\n\n    const line = (file.content.substring(0, match.index).match(/\\n/g) || []).length + 1;\n    yield {\n      path,\n      previousCharacter,\n      nextCharacter,\n      file: file.fileName,\n      line,\n    };\n  }\n}\n\n/**\n * Extracts translation keys from methods such as `$t` and `$tc`.\n *\n * - **regexp pattern**: (?:[$ .]tc?)\\(\n *\n *   **description**: Matches the sequence t( or tc(, optionally with either “$”, “.” or “ ” in front of it.\n *\n * - **regexp pattern**: ([\"'`])\n *\n *   **description**: 1. capturing group. Matches either “\"”, “'”, or “`”.\n *\n * - **regexp pattern**: ((?:[^\\\\]|\\\\.)*?)\n *\n *   **description**: 2. capturing group. Matches anything except a backslash\n *   *or* matches any backslash followed by any character (e.g. “\\\"”, “\\`”, “\\t”, etc.)\n *\n * - **regexp pattern**: \\1\n *\n *   **description**: matches whatever was matched by capturing group 1 (e.g. the starting string character)\n *\n * @param file a file object\n * @returns a list of translation keys found in `file`.\n */\n function extractMethodMatches (file: SimpleFile): I18NItemWithBounding[] {\n  const methodRegExp = /(?:[$ .]tc?)\\(\\s*?([\"'`])((?:[^\\\\]|\\\\.)*?)\\1/g;\n  return [ ...getMatches(file, methodRegExp, 2) ];\n}\n\nfunction extractComponentMatches (file: SimpleFile): I18NItemWithBounding[] {\n  const componentRegExp = /(?:<(?:i18n|Translation))(?:.|\\n)*?(?:[^:]path=(\"|'))((?:[^\\\\]|\\\\.)*?)\\1/gi;\n  return [ ...getMatches(file, componentRegExp, 2) ];\n}\n\nfunction extractDirectiveMatches (file: SimpleFile): I18NItemWithBounding[] {\n  const directiveRegExp = /v-t=\"'((?:[^\\\\]|\\\\.)*?)'\"/g;\n  return [ ...getMatches(file, directiveRegExp) ];\n}\n\nfunction extractI18nItemsFromVueFiles (sourceFiles: SimpleFile[]): I18NItemWithBounding[] {\n  return sourceFiles.reduce((accumulator, file) => {\n    const methodMatches = extractMethodMatches(file);\n    const componentMatches = extractComponentMatches(file);\n    const directiveMatches = extractDirectiveMatches(file);\n    return [\n      ...accumulator,\n      ...methodMatches,\n      ...componentMatches,\n      ...directiveMatches,\n    ];\n  }, [] as I18NItemWithBounding[]);\n}\n\nexport function parseVueFiles (vueFilesPath: string): I18NItemWithBounding[] {\n  const filesList = readVueFiles(vueFilesPath);\n  return extractI18nItemsFromVueFiles(filesList);\n}\n","import path from 'path';\nimport fs from 'fs';\nimport glob from 'glob';\nimport dot from 'dot-object';\nimport yaml from 'js-yaml';\nimport isValidGlob from 'is-valid-glob';\nimport { SimpleFile, I18NLanguage, I18NItem } from '../types';\n\nfunction readLangFiles (src: string): SimpleFile[] {\n  if (!isValidGlob(src)) {\n    throw new Error(`languageFiles isn't a valid glob pattern.`);\n  }\n\n  const targetFiles = glob.sync(src);\n\n  if (targetFiles.length === 0) {\n    throw new Error('languageFiles glob has no files.');\n  }\n\n  return targetFiles.map(f => {\n    const langPath = path.resolve(process.cwd(), f);\n\n    const extension = langPath.substring(langPath.lastIndexOf('.')).toLowerCase();\n    const isJSON = extension === '.json';\n    const isYAML = extension === '.yaml' || extension === '.yml';\n\n    let langObj;\n    if (isJSON) {\n      langObj = JSON.parse(fs.readFileSync(langPath, 'utf8'));\n    } else if (isYAML) {\n      langObj = yaml.load(fs.readFileSync(langPath, 'utf8'));\n    } else {\n      langObj = eval(fs.readFileSync(langPath, 'utf8'));\n    }\n\n    const fileName = f.replace(process.cwd(), '');\n\n    return { path: f, fileName, content: JSON.stringify(langObj) };\n  });\n}\n\nfunction extractI18nItemsFromLanguageFiles (languageFiles: SimpleFile[]): I18NLanguage {\n  return languageFiles.reduce((accumulator, file) => {\n    const language = file.fileName.substring(file.fileName.lastIndexOf('/') + 1, file.fileName.lastIndexOf('.'));\n\n    if (!accumulator[language]) {\n      accumulator[language] = [];\n    }\n\n    const flattenedObject = dot.dot(JSON.parse(file.content));\n    Object.keys(flattenedObject).forEach((key, index) => {\n      accumulator[language].push({\n        path: key,\n        file: file.fileName,\n        line: index,\n      });\n    });\n\n    return accumulator;\n  }, {});\n}\n\nexport function writeMissingToLanguage (resolvedLanguageFiles: string, missingKeys: I18NItem[]): void {\n  const languageFiles = readLangFiles(resolvedLanguageFiles);\n  languageFiles.forEach(languageFile => {\n    const languageFileContent = JSON.parse(languageFile.content);\n\n    missingKeys.forEach(item => {\n      if (item.language && languageFile.fileName.includes(item.language) || !item.language) {\n        dot.str(item.path, '', languageFileContent);\n      }\n    });\n\n    const fileExtension = languageFile.fileName.substring(languageFile.fileName.lastIndexOf('.') + 1);\n    const filePath = languageFile.path;\n    const stringifiedContent = JSON.stringify(languageFileContent, null, 2);\n\n    if (fileExtension === 'json') {\n      fs.writeFileSync(filePath, stringifiedContent);\n    } else if (fileExtension === 'js') {\n      const jsFile = `export default ${stringifiedContent}; \\n`;\n      fs.writeFileSync(filePath, jsFile);\n    } else if (fileExtension === 'yaml' || fileExtension === 'yml') {\n      const yamlFile = yaml.dump(languageFileContent);\n      fs.writeFileSync(filePath, yamlFile);\n    }\n  });\n}\n\nexport function parseLanguageFiles (languageFilesPath: string): I18NLanguage {\n  const filesList = readLangFiles(languageFilesPath);\n  return extractI18nItemsFromLanguageFiles(filesList);\n}\n","import fs from 'fs';\nimport { I18NItem, I18NItemWithBounding, I18NLanguage, I18NReport } from '../types';\n\nfunction stripBounding (item: I18NItemWithBounding): I18NItem {\n  return {\n    path: item.path,\n    file: item.file,\n    line: item.line,\n  }\n}\n\nfunction mightBeDynamic (item: I18NItemWithBounding): boolean {\n  return item.path.includes('${') && !!item.previousCharacter.match(/`/g) && !!item.nextCharacter.match(/`/g);\n}\n\n// Looping through the arays multiple times might not be the most effecient, but it's the easiest to read and debug. Which at this scales is an accepted trade-off.\nexport function extractI18NReport (vueItems: I18NItemWithBounding[], languageFiles: I18NLanguage): I18NReport {\n  const missingKeys: I18NItem[] = [];\n  const unusedKeys: I18NItem[] = [];\n\n  const maybeDynamicKeys: I18NItem[] = vueItems\n    .filter(vueItem => mightBeDynamic(vueItem))\n    .map(vueItem => stripBounding(vueItem));\n\n  Object.keys(languageFiles).forEach(language => {\n    const languageItems = languageFiles[language];\n\n    const missingKeysInLanguage = vueItems\n      .filter(vueItem => !mightBeDynamic(vueItem))\n      .filter(vueItem => !languageItems.some(languageItem => vueItem.path === languageItem.path))\n      .map(vueItem => ({ ...stripBounding(vueItem), language }));\n\n    const unusedKeysInLanguage = languageItems\n      .filter(languageItem => !vueItems.some(vueItem => languageItem.path === vueItem.path || languageItem.path.startsWith(vueItem.path + '.')))\n      .map(languageItem => ({ ...languageItem, language }));\n\n    missingKeys.push(...missingKeysInLanguage);\n    unusedKeys.push(...unusedKeysInLanguage);\n  });\n\n  return {\n    missingKeys,\n    unusedKeys,\n    maybeDynamicKeys,\n  };\n}\n\nexport async function writeReportToFile (report: I18NReport, writePath: string): Promise<NodeJS.ErrnoException | void> {\n  const reportString = JSON.stringify(report);\n  return new Promise((resolve, reject) => {\n    fs.writeFile(\n      writePath,\n      reportString,\n      (err) => {\n        if (err) {\n          reject(err);\n          return;\n        }\n        resolve();\n      },\n    );\n  });\n}\n\n","import path from 'path';\n\nimport { ReportOptions, I18NReport } from '../types';\nimport { parseVueFiles } from './vue-files';\nimport { parseLanguageFiles, writeMissingToLanguage } from './language-files';\nimport { extractI18NReport,  writeReportToFile } from './report';\n\nexport function createI18NReport (vueFiles: string, languageFiles: string): I18NReport {\n  const resolvedVueFiles = path.resolve(process.cwd(), vueFiles);\n  const resolvedLanguageFiles = path.resolve(process.cwd(), languageFiles);\n\n  const parsedVueFiles = parseVueFiles(resolvedVueFiles);\n  const parsedLanguageFiles = parseLanguageFiles(resolvedLanguageFiles);\n\n  return extractI18NReport(parsedVueFiles, parsedLanguageFiles);\n}\n\nexport async function reportCommand (command: ReportOptions): Promise<void> {\n  const { vueFiles, languageFiles, output, add, ci } = command;\n  const report = createI18NReport(vueFiles, languageFiles);\n\n  if (report.missingKeys.length) console.info('\\nMissing Keys'), console.table(report.missingKeys);\n  if (report.unusedKeys.length) console.info('\\nUnused Keys'), console.table(report.unusedKeys);\n  if (report.maybeDynamicKeys.length) console.warn('\\nSuspected Dynamic Keys Found\\nvue-i18n-extract does not compile Vue templates and therefore can not infer the correct key for the following keys.'), console.table(report.maybeDynamicKeys);\n\n  if (output) {\n    await writeReportToFile(report, path.resolve(process.cwd(), output));\n    console.info(`\\nThe report has been has been saved to ${output}`);\n  }\n\n  if (add && report.missingKeys.length) {\n    const resolvedLanguageFiles = path.resolve(process.cwd(), languageFiles);\n    writeMissingToLanguage(resolvedLanguageFiles, report.missingKeys);\n    console.info('\\nThe missing keys have been added to your languages files');\n  }\n\n  if (ci && report.missingKeys.length) {\n    console.info(`[vue-i18n-extract] ${report.missingKeys.length} missing keys found.`);\n    process.exit(1);\n  }\n\n  console.log('hi');\n\n  process.exit(0);\n}\n\n\nexport * from './vue-files';\nexport * from './language-files';\nexport * from './report';\n"],"names":["vueFiles","languageFiles","output","add","ci","initCommand","fs","writeFileSync","path","resolve","process","cwd","JSON","stringify","defaultConfig","resolveConfig","pathToConfigFile","configFile","require","console","info","argsFromConfigFile","Object","keys","map","key","reduce","accumulator","index","value","values","argv","readVueFiles","src","isValidGlob","Error","targetFiles","glob","sync","length","f","fileName","replace","content","readFileSync","getMatches","file","regExp","captureGroup","match","exec","pathAtIndex","indexOf","previousCharacter","charAt","nextCharacter","line","substring","extractMethodMatches","methodRegExp","extractComponentMatches","componentRegExp","extractDirectiveMatches","directiveRegExp","extractI18nItemsFromVueFiles","sourceFiles","methodMatches","componentMatches","directiveMatches","parseVueFiles","vueFilesPath","filesList","readLangFiles","langPath","extension","lastIndexOf","toLowerCase","isJSON","isYAML","langObj","parse","yaml","load","eval","extractI18nItemsFromLanguageFiles","language","flattenedObject","dot","forEach","push","writeMissingToLanguage","resolvedLanguageFiles","missingKeys","languageFile","languageFileContent","item","includes","str","fileExtension","filePath","stringifiedContent","jsFile","yamlFile","dump","parseLanguageFiles","languageFilesPath","stripBounding","mightBeDynamic","extractI18NReport","vueItems","unusedKeys","maybeDynamicKeys","filter","vueItem","languageItems","missingKeysInLanguage","some","languageItem","unusedKeysInLanguage","startsWith","writeReportToFile","report","writePath","reportString","Promise","reject","writeFile","err","createI18NReport","resolvedVueFiles","parsedVueFiles","parsedLanguageFiles","reportCommand","command","table","warn","exit","log"],"mappings":"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"}