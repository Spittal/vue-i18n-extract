!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("path"),require("is-valid-glob"),require("glob"),require("fs"),require("dot-object"),require("js-yaml"),require("esm")):"function"==typeof define&&define.amd?define(["path","is-valid-glob","glob","fs","dot-object","js-yaml","esm"],t):(e=e||self).vueI18NExtract=t(e.path,e.isValidGlob,e.glob,e.fs,e.dot,e.yaml,e.esm)}(this,function(e,t,r,n,a,s,l){function*i(e,t,r){for(void 0===r&&(r=1);;){var n=t.exec(e.content);if(null===n)break;var a=(e.content.substring(0,n.index).match(/\n/g)||[]).length+1;yield{path:n[r],line:a,file:e.fileName}}}function o(a){if(!t(a))throw new Error("languageFiles isn't a valid glob pattern.");var l=r.sync(a);if(0===l.length)throw new Error("languageFiles glob has no files.");return l.map(t=>{var r=e.resolve(process.cwd(),t),a=r.substring(r.lastIndexOf(".")).toLowerCase(),l=".yaml"===a||".yml"===a?s.safeLoad(n.readFileSync(r,"utf8")):require(r),i=l.default?l.default:l;return{fileName:t.replace(process.cwd(),""),path:t,content:JSON.stringify(i)}})}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var f;return e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,l=l&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l,require=l(module),function(e){e[e.None=0]="None",e[e.Missing=1]="Missing",e[e.Unused=2]="Unused",e[e.All=3]="All"}(f||(f={})),{report:async function(l){var{vueFiles:c,languageFiles:d,output:p,add:g}=l,y=e.resolve(process.cwd(),c),h=e.resolve(process.cwd(),d),m=function(e,t,r){void 0===r&&(r=f.All);var n=[],a=[];Object.keys(t).forEach(r=>{var s=t[r];e.forEach(e=>{var a=function(t){return t.path===e.path||t.path.startsWith(e.path+".")};t[r].some(a)||n.push(u({},e,{language:r})),s=s.filter(e=>!a(e))}),a.push(...s.map(e=>u({},e,{language:r})))});var s={};return r&f.Missing&&(s=Object.assign(s,{missingKeys:n})),r&f.Unused&&(s=Object.assign(s,{unusedKeys:a})),s}(function(e){if(!t(e))throw new Error("vueFiles isn't a valid glob pattern.");var a=r.sync(e);if(0===a.length)throw new Error("vueFiles glob has no files.");return a.map(e=>({fileName:e.replace(process.cwd(),""),path:e,content:n.readFileSync(e,"utf8")}))}(y).reduce((e,t)=>[...e,...function(e){return[...i(e,/(?:[$ .]tc?)\(\s*?(["'`])((?:[^\\]|\\.)*?)\1/g,2)]}(t),...function(e){return[...i(e,/(?:<i18n|<I18N)(?:.|\n)*?(?:[^:]path=("|'))(.*?)\1/g,2)]}(t),...function(e){return[...i(e,/v-t="'(.*?)'"/g)]}(t)],[]),o(h).reduce((e,t)=>{var r=t.fileName.substring(t.fileName.lastIndexOf("/")+1,t.fileName.lastIndexOf(".")),n=a.dot(JSON.parse(t.content)),s=Object.keys(n).map((e,r)=>({line:r,path:e,file:t.fileName}));return e[r]=s,e},{}));m.missingKeys&&console.table(m.missingKeys),m.unusedKeys&&console.table(m.unusedKeys),p&&(await async function(e,t){var r=JSON.stringify(e);return new Promise((e,a)=>{n.writeFile(t,r,t=>{t?a(t):e()})})}(m,e.resolve(process.cwd(),p)),console.log("The report has been has been saved to "+p)),g&&m.missingKeys&&m.missingKeys.length>0&&(function(t,r){o(t).forEach(t=>{var l=JSON.parse(t.content);r.forEach(e=>{(e.language&&t.fileName.includes(e.language)||!e.language)&&a.str(e.path,"",l)});var i=t.fileName.substring(t.fileName.lastIndexOf(".")+1),o=e.resolve(process.cwd()+t.fileName),u=JSON.stringify(l,null,2);if("json"===i)n.writeFileSync(o,u);else if("js"===i)n.writeFileSync(o,"export default "+u+"; \n");else if("yaml"===i||"yml"===i){var f=s.safeDump(l);n.writeFileSync(o,f)}})}(h,m.missingKeys),console.log("The missing keys have been added to your languages files"))}}});
//# sourceMappingURL=vue-i18n-extract.umd.js.map
